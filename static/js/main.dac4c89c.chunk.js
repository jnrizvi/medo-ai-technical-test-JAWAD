(this["webpackJsonpimage-annotator-js"]=this["webpackJsonpimage-annotator-js"]||[]).push([[0],{132:function(e,t,n){},136:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(25),i=n.n(o),c=(n(72),n(51)),s=n(15),l=n(14),u=n(16),h=n(17),g=n(18),m=n(20),d=n(52),p=n.n(d),f=n(156),y=n(157),v=n(158),w=n(154),k=n(54),O=n.n(k),S=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(w.a,{variant:"contained",component:"label",startIcon:r.a.createElement(O.a,null)},"Upload Image",r.a.createElement("input",{type:"file",style:{display:"none"},onChange:this.props.handleImageUpload}))}}]),t}(r.a.Component),b=n(57),E=n.n(b),j=n(56),x=n.n(j),N=n(55),C=n.n(N),I=Object(f.a)((function(e){return{root:{flexGrow:1,minWidth:"800px"},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1,display:"flex",justifyContent:"flex-end"}}}));function D(e){var t=I();return r.a.createElement("div",{className:t.root},r.a.createElement(y.a,{position:"static",style:{backgroundColor:"#212121"}},r.a.createElement(v.a,null,r.a.createElement(S,{handleImageUpload:e.handleImageUpload}),r.a.createElement(w.a,{variant:"contained",color:"inherit",style:{marginLeft:"20px",backgroundColor:"blue"},onClick:e.handleJSONOutputClicked,startIcon:r.a.createElement(C.a,null)},"JSON Output"),r.a.createElement("div",{className:t.title},r.a.createElement(w.a,{variant:"contained",color:"inherit",style:{backgroundColor:"green"},onClick:e.handleInteresting,startIcon:r.a.createElement(x.a,null)},"Interesting"),r.a.createElement(w.a,{variant:"contained",color:"secondary",style:{marginLeft:"20px"},onClick:e.handleUninteresting,startIcon:r.a.createElement(E.a,null)},"Uninteresting")))))}var U=n(19),M=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).handleChange=function(e){var t=Object(U.a)(n).props.onTransform,a=e.target;t({x:a.x(),y:a.y(),width:a.width()*a.scaleX(),height:a.height()*a.scaleY(),rotation:a.rotation()})},n.handleMouseEnter=function(e){var t=e.target;t.stroke(n.props.strokes[1]),t.getStage().container().style.cursor="move",n.rect.getLayer().draw()},n.handleMouseLeave=function(e){var t=e.target;t.stroke(n.props.strokes[0]),t.getStage().container().style.cursor="default",n.rect.getLayer().draw()},n}return Object(g.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(){this.rect.getLayer().batchDraw()}},{key:"render",value:function(){var e=this,t=this.props,n=t.x,a=t.y,o=t.width,i=t.height,c=t.name,s=t.strokes,l=this.handleChange,u=this.handleMouseEnter,h=this.handleMouseLeave;return r.a.createElement(m.Rect,{x:n,y:a,width:o,height:i,scaleX:1,scaleY:1,stroke:s[0],strokeWidth:1.5,name:c,onDragEnd:l,onTransformEnd:l,onMouseEnter:u,onMouseLeave:h,draggable:!0,ref:function(t){e.rect=t}})}}]),t}(r.a.Component),R=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).checkNode=function(){var e=n.transformer.getStage(),t=n.props.selectedShapeName,a=e.findOne(".".concat(t));a!==n.transformer.node()&&(a?n.transformer.attachTo(a):n.transformer.detach())},n}return Object(g.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.checkNode()}},{key:"componentDidUpdate",value:function(){this.checkNode()}},{key:"render",value:function(){var e=this;return r.a.createElement(m.Transformer,{ref:function(t){e.transformer=t},rotateEnabled:!1})}}]),t}(r.a.Component),L=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={image:null},n}return Object(g.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=new window.Image;t.src="",t.onload=function(){e.setState({image:t})}}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this;if(e.img!==this.state.image){var n=new window.Image;n.src=e.img,n.onload=function(){t.setState({image:n})}}}},{key:"render",value:function(){var e=this.state.image,t=null,n=null;return e&&(t=250-e.height/2,n=400-e.width/2),r.a.createElement(m.Image,{x:n,y:t,image:e})}}]),t}(r.a.Component),T=(n(132),n(159)),P=n(160),J=n(35),W=n(161),A=n(59),X=n.n(A),Y=n(58),B=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={rectangles:[],rectCount:0,selectedShapeName:"",mouseDown:!1,mouseDraw:!1,newRectX:0,newRectY:0,imgData:null,imgName:"default.xyz",strokePrimary:"green",strokeSecondary:"lightgreen",type:"Interesting",jsonOutput:"No JSON Output received yet."},n.handleStageMouseDown=function(e){var t=n.state.rectangles;if("Image"!==e.target.className){if(e.target.getParent())if("Transformer"===e.target.getParent().className)return;var a=e.target.name();t.find((function(e){return e.name===a}))?n.setState({selectedShapeName:a,rectangles:t}):n.setState({selectedShapeName:""})}else{var r=e.target.getStage().getPointerPosition();n.setState({mouseDown:!0,newRectX:r.x,newRectY:r.y,selectedShapeName:""})}},n.handleRectChange=function(e,t){var a=n.state.rectangles;a[e]=Object(c.a)({},a[e],{},t),n.setState({rectangles:a})},n.handleNewRectChange=function(e){var t=n.state,a=t.rectangles,r=t.rectCount,o=t.newRectX,i=t.newRectY,c=e.target.getStage().getPointerPosition();return a[r]?(a[r].width=c.x-o,a[r].height=c.y-i,n.setState({rectangles:a})):(a.push({x:o,y:i,width:c.x-o,height:c.y-i,name:"rect".concat(r+1),strokes:[n.state.strokePrimary,n.state.strokeSecondary],type:n.state.type,key:p.a.generate()}),n.setState({rectangles:a,mouseDraw:!0}))},n.handleStageMouseUp=function(){var e=n.state,t=e.rectCount;e.mouseDraw&&n.setState({rectCount:t+1,mouseDraw:!1}),n.setState({mouseDown:!1})},n.handleImageUpload=function(e){n.setState({imgData:URL.createObjectURL(e.target.files[0]),imgName:e.target.files[0].name})},n.handleInteresting=function(){return n.setState({strokePrimary:"green",strokeSecondary:"lightgreen",type:"Interesting"})},n.handleUninteresting=function(){return n.setState({strokePrimary:"red",strokeSecondary:"tomato",type:"Uninteresting"})},n.handleJSONOutputClicked=function(){var e={imageName:n.state.imgName,annotations:[]};n.state.rectangles.forEach((function(t){e.annotations.push({annotationID:t.key,upperLeft:{pointID:t.name+"UL",x:t.x,y:t.y},lowerRight:{pointID:t.name+"LR",x:t.x+t.width,y:t.y+t.height},type:t.type})})),n.setState({jsonOutput:JSON.stringify(e)})},n}return Object(g.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.img.moveToBottom()}},{key:"render",value:function(){var e=this,t=this.state,n=t.rectangles,a=t.selectedShapeName,o=t.mouseDown,i=this.handleStageMouseDown,c=this.handleNewRectChange,s=this.handleRectChange,l=this.handleStageMouseUp;return[r.a.createElement(D,{key:"toolbar",handleImageUpload:this.handleImageUpload,handleJSONOutputClicked:this.handleJSONOutputClicked,handleInteresting:this.handleInteresting,handleUninteresting:this.handleUninteresting}),r.a.createElement("div",{key:"content",style:{display:"flex",justifyContent:"center"}},r.a.createElement(T.a,{style:{flexGrow:1,margin:"20px",padding:"20px",paddingTop:0,minWidth:"260px",maxWidth:"360px",width:"80%",height:"400px",alignSelf:"center"}},r.a.createElement(P.a,{style:{padding:"10px"},title:"JSON Output",action:r.a.createElement(Y.CopyToClipboard,{text:this.state.jsonOutput},r.a.createElement(W.a,{"aria-label":"settings",style:{marginTop:"10px"}},r.a.createElement(X.a,null)))}),r.a.createElement(J.a,{style:{wordWrap:"break-word",position:"relative",height:"100%",overflow:"auto"}},this.state.jsonOutput)),r.a.createElement("div",{id:"image-container"},r.a.createElement(m.Stage,{ref:function(t){e.stage=t},container:"image-container",width:800,height:500,onMouseDown:i,onTouchStart:i,onMouseMove:o&&c,onTouchMove:o&&c,onMouseUp:o&&l,onTouchEnd:o&&l},r.a.createElement(m.Layer,null,n.map((function(e,t){return r.a.createElement(M,Object.assign({sclassName:"rect",key:e.key},e,{onTransform:function(e){s(t,e)}}))})),r.a.createElement(R,{selectedShapeName:a})),r.a.createElement(m.Layer,{ref:function(t){e.img=t}},r.a.createElement(L,{img:this.state.imgData})))))]}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(B,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},68:function(e,t,n){e.exports=n(136)},72:function(e,t,n){}},[[68,1,2]]]);
//# sourceMappingURL=main.dac4c89c.chunk.js.map